## è¡¨è¾¾
è¡¨è¾¾ï¼ˆRepresentationï¼‰æŒ‡çš„æ˜¯å¦‚ä½•æ˜¾ç¤ºåœ°å¯¹äº‹ç‰©å»ºæ¨¡ã€‚

### åˆ†å¸ƒ
è€ƒè™‘3ä¸ªéšæœºå˜é‡ï¼Œæ¯ä¸€ä¸ªå˜é‡å¯é€‰å€¼å¦‚å¦‚ä¸‹ï¼š

Intelligence(I) -- $i^{0}$ (low), $i^{1}$ (high)

Difficulty(D) -- $d^{0}$ (easy), $d^{1}$ (hard)

Grade(G) -- $g^{1}$ (A), $g^{2}$ (B), $g^{3}$ (C)

è”åˆåˆ†å¸ƒï¼ˆJoint Distributionï¼‰$P(I, D, G)$ å¦‚ä¸‹

| I | D | G | Prob |
| :----: | :----: | :----: | :----: |
| $i^{0}$ | $d^{0}$ | $g^{1}$ | 0.126 |
| $i^{0}$ | $d^{0}$ | $g^{2}$ | 0.168 |
| $i^{0}$ | $d^{0}$ | $g^{3}$ | 0.126 |
| $i^{0}$ | $d^{1}$ | $g^{1}$ | 0.009 |
| $i^{0}$ | $d^{1}$ | $g^{2}$ | 0.045 |
| $i^{0}$ | $d^{1}$ | $g^{3}$ | 0.126 |
| $i^{1}$ | $d^{0}$ | $g^{1}$ | 0.252 |
| $i^{1}$ | $d^{0}$ | $g^{2}$ | 0.0224 |
| $i^{1}$ | $d^{0}$ | $g^{3}$ | 0.0056 |
| $i^{1}$ | $d^{1}$ | $g^{1}$ | 0.06 |
| $i^{1}$ | $d^{1}$ | $g^{2}$ | 0.036 |
| $i^{1}$ | $d^{1}$ | $g^{3}$ | 0.024 |

æ¡ä»¶æ¦‚ç‡ï¼ˆConditional probabilityï¼‰$P(I, D \mid g^{1})$

| I | D | Prob |
| :----: | :----: | :----: |
| $i^{0}$ | $d^{0}$ | 0.282 |
| $i^{0}$ | $d^{1}$ | 0.02 |
| $i^{1}$ | $d^{0}$ | 0.564 |
| $i^{1}$ | $d^{1}$ | 0.134 |

è¾¹ç¼˜åŒ–ï¼ˆMarginalizationï¼‰

$$
\sum_{I} P(I, D) = P(D)
$$

| D | Prob |
| :----: | :----: |
| $d^{0}$ | 0.846 |
| $d^{1}$ | 0.154 |

### å› å­
å› å­ï¼ˆfactorï¼‰æ˜¯ä¸€ç§å¯¹é«˜çº¬åˆ†å¸ƒçš„åŸºç¡€è¡¨è¾¾å½¢å¼ï¼Œå¦‚ $\phi(X_{1}, \cdots, X_{k})$ï¼Œè¿™é‡Œ $\phi$ è¡¨ç¤ºåœ¨éšæœºå˜é‡å–æŸä¸€ğŸˆ¯å€¼åçš„å› å­å€¼ $Val(X_{1}, \cdots, X_{k}) \rightarrow R$

å› å­çš„**å€¼åŸŸï¼ˆScopeï¼‰** $\{ X_{1}, \cdots, X_{k} \}$

å› å­ç›¸ä¹˜ $\phi(A, B, C) \cdot \phi(C, D)$ åçš„å€¼åŸŸ {A, B, C, D} å…¶ä¸­ P(I, D, G) å’Œ P(I, D, $g^{1}$) éƒ½æ˜¯å› å­ã€‚

#### å› å­ç›¸ä¹˜
å‡è®¾ Xï¼ŒY å’Œ Z æ˜¯äºŒå€¼å˜é‡ï¼Œ$\phi_1(X,Y)$ å’Œ $\phi_2(Y, Z)$ æ˜¯ä¸¤ä¸ªå› å­å¦‚ä¸‹

| X | Y | $\phi_{1}(X, Y)$ |
| :----: | :----: | :----: |
| 1 | 1 | 0.8 |
| 1 | 2 | 0.5 |
| 2 | 1 | 0.5 |
| 2 | 2 | 0.6 |

| Y | Z | $\phi_{2}(Y, Z)$ |
| :----: | :----: | :----: |
| 1 | 1 | 0.2 |
| 1 | 2 | 0.2 |
| 2 | 1 | 0.9 |
| 2 | 2 | 1.0 |

ä¸¤ä¸ªå› å­çš„ä¹˜ç§¯å¾—åˆ°æ–°å› å­ $\psi(X, Y, Z) = \phi_1(X,Y) \cdot \phi_2(Y, Z)$ å¦‚ä¸‹

| X | Y | Z | $\psi(X, Y, Z)$ |
| :----: | :----: | :----: | :----: |
| 1 | 1 | 1 | 0.16 |
| 1 | 1 | 2 | 0.16 |
| 1 | 2 | 1 | 0.45 |
| 1 | 2 | 2 | 0.5 |
| 2 | 1 | 1 | 0.1 |
| 2 | 1 | 2 | 0.1 |
| 2 | 2 | 1 | 0.54 |
| 2 | 2 | 2 | 0.6 |

#### å› å­é€€åŒ–
è®¾ X å’Œ Z æ˜¯äºŒå€¼å˜é‡ï¼Œå˜é‡ Y å¯å– 1ï¼Œ2ï¼Œ3 ä¸‰ä¸ªå€¼ã€‚å› å­ $\phi(X,Y,Z)$ å¦‚ä¸‹

| X | Y | Z | $\phi(X, Y, Z)$ |
| :----: | :----: | :----: | :----: |
| 1 | 1 | 1 | 14 |
| 1 | 1 | 2 | 60 |
| 1 | 2 | 1 | 40 |
| 1 | 2 | 2 | 27 |
| 1 | 3 | 1 | 42 |
| 1 | 3 | 2 | 85 |
| 2 | 1 | 1 | 4 |
| 2 | 1 | 2 | 59 |
| 2 | 2 | 1 | 54 |
| 2 | 2 | 2 | 3 |
| 2 | 3 | 1 | 96 |
| 2 | 3 | 2 | 30 |

è§‚å¯Ÿåˆ° Y = 2ï¼Œæ±‚æ­¤æ—¶çš„å› å­ $\psi(X, Y=2, Z)$

| X | Z | $\psi(X, Z)$ |
| :----: | :----: | :----: |
| 1 | 1 | 40 |
| 1 | 2 | 27 |
| 2 | 1 | 54 |
| 2 | 2 | 3 |

#### å› å­è¾¹ç¼˜åŒ–
è®¾ X å’Œ Z æ˜¯äºŒå€¼å˜é‡ï¼Œå˜é‡ Y å¯å– 1ï¼Œ2ï¼Œ3 ä¸‰ä¸ªå€¼ã€‚å› å­ $\phi(X,Y,Z)$ å¦‚ä¸‹

| X | Y | Z | $\phi(X, Y, Z)$ |
| :----: | :----: | :----: | :----: |
| 1 | 1 | 1 | 68 |
| 1 | 1 | 2 | 95 |
| 1 | 2 | 1 | 65 |
| 1 | 2 | 2 | 63 |
| 1 | 3 | 1 | 57 |
| 1 | 3 | 2 | 5 |
| 2 | 1 | 1 | 40 |
| 2 | 1 | 2 | 40 |
| 2 | 2 | 1 | 14 |
| 2 | 2 | 2 | 78 |
| 2 | 3 | 1 | 16 |
| 2 | 3 | 2 | 89 |

ç°åœ¨å¯¹ X è¾¹ç¼˜åŒ–ï¼Œ$\psi(Y, Z) = \sum_X \phi(X,Y,Z)$ï¼Œæ–°çš„å› å­å¦‚ä¸‹

| Y | Z | $\psi(X, Z)$ |
| :----: | :----: | :----: |
| 1 | 1 | 108 |
| 1 | 2 | 135 |
| 2 | 1 | 79 |
| 2 | 2 | 141 |
| 3 | 1 | 73 |
| 3 | 2 | 94 |


### è´å¶æ–¯ç½‘ç»œ
#### è¯­æ„ & å› å­åŒ–
è€ƒè™‘5ä¸ªéšæœºå˜é‡ï¼šæˆç»©ï¼ˆGï¼‰ï¼Œè¯¾ç¨‹éš¾åº¦ï¼ˆDï¼‰ï¼Œå­¦ç”Ÿæ™ºåŠ›æ°´å¹³ï¼ˆIï¼‰ï¼Œå­¦ç”ŸSATåˆ†æ•°ï¼ˆSï¼‰ï¼Œæ˜¯å¦æœ‰æ¨èä¿¡ï¼ˆLï¼‰ï¼Œä¸€ä¸ªå¯èƒ½çš„æ¨¡å‹å¦‚ä¸‹ï¼š

$$
\begin{matrix}
& D & & & & I & \\
& & \searrow & & \swarrow & & \searrow & \\
& & & G & & & &S \\
& & & \downarrow \\
& & & L
\end{matrix}
$$

æ¯ä¸€ä¸ªå˜é‡ Dã€Iã€Gã€Sã€L çš„åˆ†å¸ƒå¦‚ä¸‹ P(D) P(I) P(G | I,D) P(S | I) P(L | G)

| $d^{0}$ | $d^{1}$ |
| :----: | :----: |
| 0.6 | 0.4 |

| $i^{0}$ | $i^{1}$ |
| :----: | :----: |
| 0.7 | 0.3 |

|  | $g^{1}(A)$ | $g^{2}(B)$ | $g^{3}(C)$ |
| :----: | :----: | :----: | :----: |
| $i^{0},d^{0}$ | 0.3 | 0.4 | 0.3 |
| $i^{0},d^{1}$ | 0.05 | 0.25 | 0.7 |
| $i^{1},d^{0}$ | 0.9 | 0.08 | 0.02 |
| $i^{1},d^{1}$ | 0.5 | 0.3 | 0.2 |

|  | $s^{0}$ | $s^{1}$ |
| :----: | :----: | :----: |
| $i^{0}$ | 0.95 | 0.05 |
| $i^{1}$ | 0.2 | 0.8 |

|  | $l^{0}$ | $l^{1}$ |
| :----: | :----: | :----: |
| $g^{0}$ | 0.1 | 0.9 |
| $g^{2}$ | 0.4 | 0.6 |
| $g^{2}$ | 0.99 | 0.01 |

è”åˆåˆ†å¸ƒ P(D, I, G, S, L) æ˜¯ä¸Šé¢åˆ†å¸ƒçš„ç»„åˆ

$$
\begin{matrix}
& P(D) & & & & P(I) & \\
& & \searrow & & \swarrow & & \searrow & \\
& & & P(G|I,D) & & & & P(S|I) \\
& & & \downarrow \\
& & & P(L|G)
\end{matrix}
$$

ä¾‹å¦‚ï¼Œæ ¹æ®ä¸Šè¡¨ï¼ŒæŸä¸€ä¸ªè”åˆåˆ†å¸ƒçš„çš„æ¦‚ç‡

$$
P(d^{0}, i^{1}, g^{3}, s^{1}, l^{1}) = 0.6 \cdot 0.3 \cdot 0.02 \cdot 0.01 \cdot 0.8
$$

è´å¶æ–¯ç½‘ç»œï¼ˆBayesian Networkï¼‰æ˜¯ä¸€ä¸ªæœ‰å‘æ— ç¯å›¾ï¼ˆDAGï¼‰ï¼Œå›¾ä¸Šæ¯ä¸€ä¸ªèŠ‚ç‚¹è¡¨ç¤ºä¸€ä¸ªéšæœºå˜é‡ï¼Œå¦‚ $X_{1}$, $\cdots$, $X_{n}$ï¼Œå¹¶ä¸”æ¯ä¸€ä¸ªèŠ‚ç‚¹ $X_{i}$ éƒ½æœ‰ä¸€ä¸ªæ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ CPDï¼ˆconditional probability distributionï¼‰$P(X_{i} \mid Par_{G}(X_{i}))$ï¼Œè¿™é‡Œå…è®¸æ— çˆ¶èŠ‚ç‚¹ã€‚

æ ¹æ® chain rule æ±‚å¾—è´å¶æ–¯ç½‘ç»œçš„è”åˆåˆ†å¸ƒ

$$
P(X_{1}, \cdots, X_{n}) = \prod_{i}P(X_{i} \mid Par_{G}(X_{i}))
$$

$$
\sum_{L}P(L \mid G) = 1
$$

è”åˆåˆ†å¸ƒçš„æ¦‚ç‡å’Œä¸º1

$$
\begin{aligned}
\sum_{D, I, G, S, L} P(D, I, G, S, L) & = \sum_{D, I, G, S, L} P(D)P(I)P(G \mid I,D)P(S \mid I)P(L \mid G) \\
& = \sum_{D, I, G, S} P(D)P(I)P(G \mid I,D)P(S \mid I)\sum_{L}P(L \mid G) \\
& = \sum_{D, I, G, S} P(D)P(I)P(G \mid I,D)P(S \mid I) \\
& = \sum_{D, I, G} P(D)P(I)P(G \mid I,D)\sum_{S}P(S \mid I) \\
& = \sum_{D, I, G} P(D)P(I)P(G \mid I,D) \\
& = \sum_{D, I} P(D)P(I)\sum_{G}P(G \mid I,D) = \sum_{D, I} P(D)P(I) \\
& = 1
\end{aligned}
$$

å¦‚æœ G è¡¨ç¤ºä¸€ä¸ªå›¾ $X_{1}$, $\cdots$, $X_{n}$ï¼Œè”åˆæ¦‚ç‡ P å¯ä»¥åœ¨å›¾ä¸Šå› å­åŒ–ã€‚éœ€è¦æ»¡è¶³å¦‚ä¸‹

$$
P(X_{1}, \cdots, X_{n}) = \prod_{i}P(X_{i} \mid Par_{G}(X_{i}))
$$

```python
D = {0: 0.6, 1: 0.4}
I = {0: 0.7, 1: 0.3}
G = {1: {(0, 0): 0.3, (0, 1): 0.05, (1, 0): 0.9, (1, 1): 0.5},
        2: {(0, 0): 0.4, (0, 1): 0.25, (1, 0): 0.08, (1, 1): 0.3},
        3: {(0, 0): 0.3, (0, 1): 0.7, (1, 0): 0.02, (1, 1): 0.2}}
S = {0: {0: 0.95, 1: 0.2},
        1: {0: 0.05, 1: 0.8}}
L = {0: {1: 0.1, 2: 0.4, 3: 0.99},
        1: {1: 0.9, 2: 0.6, 3: 0.01}}
P = 0
def Prob(d=None, i=None, g=None, s=None, l=None):
    if d is None:
        D_keys = D.keys()
    else:
        D_keys = [d]
    if i is None:
        I_keys = I.keys()
    else:
        I_keys = [i]
    if g is None:
        G_keys = G.keys()
    else:
        G_keys = [g]
    if s is None:
        S_keys = S.keys()
    else:
        S_keys = [s]
    if l is None:
        L_keys = L.keys()
    else:
        L_keys = [l]
    P = 0
    for d in D_keys:
        for i in I_keys:
            for g in G_keys:
                for s in S_keys:
                    for l in L_keys:
                        P += D[d]*I[i]*G[g][(i, d)]*S[s][i]*L[l][g]
    return P
Prob()
```
